maybe optimize commands by using refcells of the window instead of returning strings
